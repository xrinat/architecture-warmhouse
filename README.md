# Project_template

Это шаблон для решения проектной работы. Структура этого файла повторяет структуру заданий. Заполняйте его по мере работы над решением.

# Задание 1. Анализ и планирование

<aside>

Чтобы составить документ с описанием текущей архитектуры приложения, можно часть информации взять из описания компании и условия задания. Это нормально.

</aside>

### 1. Описание функциональности монолитного приложения

**Управление отоплением:**

-Пользователи могут удалённо включать/выключать отопление в своих домах.
-Система поддерживает только централизованное подключение новой установки отопления.

**Мониторинг температуры:**

- Пользователи могут просматривать текущую температуру в своих домах через веб-интерфейс.
- Система получает данные о температуре с датчиков, установленных в домах.


### 2. Анализ архитектуры монолитного приложения

- Язык программирования: Go
- База данных: PostgreSQL
- Архитектура: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
- Взаимодействие: Синхронное, запросы обрабатываются последовательно.
- Масштабируемость: Ограничена, так как монолит сложно масштабировать по частям.
- Развертывание: Требует остановки всего приложения.

### 3. Определение доменов и границы контекстов

- Управление домами и пользователями
- Управлние отоплением
- Подключение системы отопления
- Веб приложение пользователя

### **4. Проблемы монолитного решения**

- Плохая масштабируемость.
- Отсутствие гибкост и скорости развития системы.
- Невозможность самостоятельного подключения системы отопления.
- Возможность работы только с одним ипом оборудования (системой отопления).
- Синхронная работа системы.
- Развертывание требует остановки всего приложения.
- Синхронное, запросы обрабатываются последовательно.

### 5. Визуализация контекста системы — диаграмма С4

```markdown
[Старая диаграмма контекста](/Schemas/schemaOld.puml)
```

# Задание 2. Проектирование микросервисной архитектуры
Уровень контекста имеет следующие микросервисы:
	- Пользовательский интерфейс (Web/Mobile) / API-шлюз - Единая точка входа для пользователей. Маршрутизация запросов и аутентификация
	- Сервис пользователей и домов - Управление пользователями, домами и ролями
	- Сервис управления устройствами - Регистрация, подключение и настройка устройств
	- Сервис телеметрии - Сбор и хранение данных с устройств, предоставление телеметрии
	- Сервис команд - Низкоуровневое управление устройствами: отправка команд на устройства
	- Сервис сценариев - Бизнес-логика пользовательских сценариев и автоматизации
	- Сервис интеграции с устройствами партнёров - Поддержка сторонних устройств через стандартизованные протоколы

[Диаграмма контекста](/Schemas/Schema1Context.puml)

**Диаграмма контейнеров (Containers)**
Примечания:
	- Брокер сообщений — обеспечивает асинхронную коммуникацию между сервисами, облегчает масштабирование и разгружает прямые синхронные запросы.

[Диаграмма контейнеров](/Schemas/Schema2Conteiner.puml)

**Диаграмма компонентов (Components)**

[Диаграмма компонентов Сервис управления устройствами](/Schemas/Schema3ComponentDeviceManagment.puml)
[Диаграмма компонентов Сервис управления пользователями](/Schemas/Schema3ComponentUser.puml)


**Диаграмма кода (Code)**

[Диаграмма код "Модуль регистрации устройств"](/Schemas/Schema4CodeRegisterDevice.puml)


# Задание 3. Разработка ER-диаграммы

[ER диаграмма](/Schemas/ER.puml)

# Задание 4. Создание и документирование API

### 1. Тип API

Выбор технологии взаимодействия зависит от задачи. В случае регистрации устройств в системе необходимо дождаться резальтата регистрации.
В этом случае необходимо использовать REST API.

Но для многих сервисов целесообразнее использовать асинхронное взаимодействие.
Причины: 
	- устройства публикуют телеметрию в потоковом режиме;
	- события (включение/отключение, обновление состояния, ошибка) должны распространяться мгновенно;
	- возможна временная потеря связи между сервисами;
	- пользователи не ждут ответа от каждого датчика синхронно.

### 2. Документация API

[YAML файл для Swagger на регистрацию устройства](/docs/openapi.yaml)
[Приложение для автогенерации документации Swagger](app.py) Можно запустить через "python app.py"
[Сгенерированный Swagger на регистрацию устройства](/docs/Swagger.html)


# Задание 5. Работа с docker и docker-compose


1) Сделано простое приложение temperature-api на любом удобном для вас языке программирования, которое при запросе /temperature/:id, которое отдаёт рандомное значение температуры.
2) Приложение упаковано в Docker и добавлено в docker-compose. Порт по умолчанию 8081
3) Добавлен в docker-compose файл настройки для запуска postgres с указанием скрипта инициализации ./smart_home/init.sql

Протестированы методы
- Create Sensor
- Get All Sensors

При каждом вызове отображаются разные значение температуры
